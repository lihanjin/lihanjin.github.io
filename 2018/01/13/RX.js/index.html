<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    <title>RXJS | _sUper.LEE的个人空间</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="RXJS">
    <meta name="description" content="##RX.js   ##一、函数式编程-通用函数式 1.ForEach12var arr = [&amp;apos;111&amp;apos;,&amp;apos;222&amp;apos;];arr.forEacj(item =&amp;gt; console.log(item)); 2.map1234567Array.prototype.map = function(callback) &amp;#123;    var result;">
<meta name="keywords" content="RXJS">
<meta property="og:type" content="article">
<meta property="og:title" content="RXJS">
<meta property="og:url" content="http://yoursite.com/2018/01/13/RX.js/index.html">
<meta property="og:site_name" content="_sUper.LEE的个人空间">
<meta property="og:description" content="##RX.js   ##一、函数式编程-通用函数式 1.ForEach12var arr = [&amp;apos;111&amp;apos;,&amp;apos;222&amp;apos;];arr.forEacj(item =&amp;gt; console.log(item)); 2.map1234567Array.prototype.map = function(callback) &amp;#123;    var result;">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2018-03-29T15:07:24.407Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="RXJS">
<meta name="twitter:description" content="##RX.js   ##一、函数式编程-通用函数式 1.ForEach12var arr = [&amp;apos;111&amp;apos;,&amp;apos;222&amp;apos;];arr.forEacj(item =&amp;gt; console.log(item)); 2.map1234567Array.prototype.map = function(callback) &amp;#123;    var result;">
    
        <link rel="alternate" type="application/atom+xml" title="_sUper.LEE的个人空间" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>
    <style>
                .timeline #cloud-tie-wrapper{
            display: none;
        }
        body .page-content .timeline:before {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            z-index: -1;
            width: 4px;
            height: 100%;
            margin-left: -2px;
            background: #dadada;
        }
        /* // 时间线 */
        body #busuanzi_container_page_pv{
            display: none!important;
        }
        body .comments{
            background: #fff;
            border-radius: 4px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
                padding: 42px 26px 0;
        }
        body .post-copyright .content{
                margin-bottom: 0em; 
            padding: 0px; 
        }
        body img{
            height: 100%;
        }
    </style>
</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu"  >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/3.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/logo.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">_sUper.LEE</h5>
          <a href="mailto:1213219813@qq.com" title="1213219813@qq.com" class="mail">1213219813@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                文章
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                标签
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tools"  >
                <i class="icon icon-lg icon-th-list"></i>
                工具资源
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
      
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">RXJS</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="global.search_input_hint">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">RXJS</h1>
        <h5 class="subtitle">
            
                <time datetime="2018-01-13T13:23:08.000Z" itemprop="datePublished" class="page-time">
  2018-01-13
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/RXJS/">RXJS</a></li></ul>

            
        </h5>
    </div>

    

 
</header>
        <!-- //particles 
  <div id="particles-js"></div>
    <style type="text/css">
        #particles-js {
               position: absolute;
                top: 0;
                width: 100%;
                z-index: -1;
                /* background-color: #26AFE3; */
                left: 0;
                bottom: 0;
                right: 0;
        }
    </style> -->


<div class="container body-wrap">
    
<article id="post-RX.js"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">RXJS</h1>
        <div class="post-meta">
            <time class="post-time" title="2018-01-13 21:23:08" datetime="2018-01-13T13:23:08.000Z"  itemprop="datePublished">2018-01-13</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/RXJS/">RXJS</a></li></ul>



            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <p>##RX.js</p>
<blockquote>
</blockquote>
<p>##一、函数式编程-通用函数式</p>
<p>1.<code>ForEach</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var arr = [&apos;111&apos;,&apos;222&apos;];</span><br><span class="line">arr.forEacj(item =&gt; console.log(item));</span><br></pre></td></tr></table></figure></p>
<p>2.<code>map</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Array.prototype.map = function(callback) &#123;</span><br><span class="line">    var result;</span><br><span class="line">    this.forEach((element,index) =&gt; &#123;</span><br><span class="line">        result.push(callback(element,index))</span><br><span class="line">    &#125;);</span><br><span class="line">    return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>3.<code>filter</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Array.prototype.filter = function(callback) &#123;</span><br><span class="line">    var result = [];</span><br><span class="line">    this.forEach((ele,index) =&gt; &#123;</span><br><span class="line">        if(callback(ele)&#123;</span><br><span class="line">            result.push(ele)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">    return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>4.<code>concatAll</code></p>
<blockquote>
<p>合并二维数组<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Array.prototype.concatAll = function() &#123;</span><br><span class="line">    var result = [];</span><br><span class="line">    this.forEach((array) =&gt; &#123;</span><br><span class="line">        result.push.apply(result,array);</span><br><span class="line">        //result.push(...array)   es6写法</span><br><span class="line">        //result.push.call(result,...array)</span><br><span class="line">    &#125;);</span><br><span class="line">    return result;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>##二、Observable的基本建立</p>
<blockquote>
<p><code>create</code>  <code>of</code>  <code>from</code> <code>fromEvent</code> <code>fromPromise</code> <code>never</code> <code>empty</code> <code>throw</code> <code>interval</code> <code>timer</code> 以上为<code>Observable</code>的实例方法<code>creation operator</code></p>
</blockquote>
<p>1.<code>create</code></p>
<blockquote>
<p><code>create</code>是<code>Observable</code>的基本建立方法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">var observable = Rx.Observable</span><br><span class="line">                .create((observer) =&gt; &#123;</span><br><span class="line">                    observer.next(&apos;111&apos;);</span><br><span class="line">                    observer.next(&apos;222);</span><br><span class="line">                    setTimeout(function () &#123;</span><br><span class="line">                        observer.next(&apos;333&apos;);</span><br><span class="line">                    &#125;)</span><br><span class="line">                &#125;);</span><br><span class="line">    console.log(&apos;start&apos;)</span><br><span class="line">    observable.subscribe(function (val) &#123;</span><br><span class="line">        console.log(val);</span><br><span class="line">    &#125;);</span><br><span class="line">    console.log(&apos;end&apos;)</span><br><span class="line">    //Observable 相当于推送事件可以同时推送同步和异步时间并且可以暂停</span><br><span class="line">    //上面代码会输出:</span><br><span class="line">    start</span><br><span class="line">    111</span><br><span class="line">    222</span><br><span class="line">    end</span><br><span class="line">    333</span><br><span class="line">    compelte</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>2.<code>of</code></p>
<blockquote>
<p>当同步传值时候可以直接使用of更方便简洁<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">var observable = Rx.Observable</span><br><span class="line">                    .of(&apos;111&apos;,&apos;222);</span><br><span class="line">    observable.subscribe(&#123;</span><br><span class="line">        value =&gt; console.log(vale);</span><br><span class="line">        error =&gt; console.log(error);</span><br><span class="line">        () =&gt; console.log(&apos;compelte)&apos;</span><br><span class="line">    &#125;)</span><br><span class="line">    //以上程序打印出：</span><br><span class="line">    111</span><br><span class="line">    222</span><br><span class="line">    compelte</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>3.<code>from</code></p>
<blockquote>
<p><code>from</code> 和<code>of</code>差不多<code>from</code>参数为数组,  <code>set</code>, <code>WeakSet</code>, <code>Iterator</code> </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">var arr = [&apos;1&apos;,&apos;2&apos;,&apos;3&apos;];</span><br><span class="line">var source = Rx.Observable.from(arr);</span><br><span class="line"> observable.subscribe(&#123;</span><br><span class="line">        value =&gt; console.log(vale);</span><br><span class="line">        error =&gt; console.log(error);</span><br><span class="line">        () =&gt; console.log(&apos;compelte)&apos;</span><br><span class="line">    &#125;)</span><br><span class="line">    //以上程序打印出：</span><br><span class="line">    111</span><br><span class="line">    222</span><br><span class="line">    compelte</span><br><span class="line">    //**from也可以接受字符串，例如&quot;你好&quot;会打印出：&quot;你&quot;,&quot;好&quot;,&quot;compelte&quot;**</span><br><span class="line">    //也可以传入promise</span><br><span class="line">    var source = Rx.Observable</span><br><span class="line">  .from(new Promise((resolve, reject) =&gt; &#123;</span><br><span class="line">    setTimeout(() =&gt; &#123;</span><br><span class="line">      resolve(&apos;Hello RxJS!&apos;);</span><br><span class="line">    &#125;,3000)</span><br><span class="line">  &#125;))</span><br><span class="line">  </span><br><span class="line">source.subscribe(&#123;</span><br><span class="line">    next: function(value) &#123;</span><br><span class="line">    	console.log(value)</span><br><span class="line">    &#125;,</span><br><span class="line">    complete: function() &#123;</span><br><span class="line">    	console.log(&apos;complete!&apos;);</span><br><span class="line">    &#125;,</span><br><span class="line">    error: function(error) &#123;</span><br><span class="line">    console.log(error)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// Hello RxJS!</span><br><span class="line">// complete!</span><br></pre></td></tr></table></figure>
<blockquote>
<p>如果<code>promise</code> 返回的是<code>resolve</code>则执行<code>next</code>，如果返回<code>reject</code>执行<code>error</code>，这里使用<code>formPromise</code>返回的结果也是一样的</p>
</blockquote>
<p>4.<code>fromEvent</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">var source= Rx.observable.fromEvent(document.body,&apos;click&apos;);</span><br><span class="line">source.subscribe(&#123;</span><br><span class="line">    next: function(value) &#123;</span><br><span class="line">    	console.log(value)</span><br><span class="line">    &#125;,</span><br><span class="line">    complete: function() &#123;</span><br><span class="line">    	console.log(&apos;complete!&apos;);</span><br><span class="line">    &#125;,</span><br><span class="line">    error: function(error) &#123;</span><br><span class="line">    console.log(error)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">//打印出mouseEvent()</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p><code>fromEvent</code>传入的第一个参数为dom，第二个参数为需要监听事件的名称</p>
</blockquote>
<p><strong>补充：fromEventPattern</strong></p>
<p>要用<code>Event</code>来建立<code>Observable</code>实例还有另一个方法<code>fromEventPattern</code>，这个方法是给类事件使用。所谓的类事件就是指其行为跟事件相像，同时具有注册监听及移除监听两种行为，就像<code>DOM Event</code>有<code>addEventListener</code>及<code>removeEventListener</code>一样！<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">class Producer &#123;</span><br><span class="line">	constructor() &#123;</span><br><span class="line">		this.listenList = [];</span><br><span class="line">	&#125;</span><br><span class="line">	addListener(listener) &#123;</span><br><span class="line">		if(typeof listenner === &apos;function&apos;) &#123;</span><br><span class="line">			this.listenList.push(listenner);</span><br><span class="line">		&#125; else &#123;</span><br><span class="line">			console.log(&apos;listenner 必须是方法&apos;)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	removeListener(listener) &#123;</span><br><span class="line">		this.listerList.splice(this.listerList.indexOf(listener),1)</span><br><span class="line">	&#125;</span><br><span class="line">	norify(message) &#123;</span><br><span class="line">		this.listenList.forEach(listener=&gt; &#123;</span><br><span class="line">			console.log(message)</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">//</span><br><span class="line">var egghead = new Producer();</span><br><span class="line">var souce = Rx.Observable.formEventPattern(&#123;</span><br><span class="line">	(handle) =&gt; egghead.addListener(handle);</span><br><span class="line">	(handle) =&gt; eegghead.removeListenner(handle);</span><br><span class="line">&#125;);</span><br><span class="line">source.subscribe(&#123;</span><br><span class="line">    next: function(value) &#123;</span><br><span class="line">    	console.log(value)</span><br><span class="line">    &#125;,</span><br><span class="line">    complete: function() &#123;</span><br><span class="line">    	console.log(&apos;complete!&apos;);</span><br><span class="line">    &#125;,</span><br><span class="line">    error: function(error) &#123;</span><br><span class="line">    console.log(error)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">egghandle.notify(&apos;can i listener u&apos;)</span><br><span class="line">//can i listener u</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>这里要注意不要直接将方法传入，避免<code>this</code>出错！也可以用<code>bind</code>来写。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Rx.Observable</span><br><span class="line">    .fromEventPattern(</span><br><span class="line">        egghead.addListener.bind(egghead), </span><br><span class="line">        egghead.removeListener.bind(egghead)</span><br><span class="line">    )</span><br><span class="line">    .subscribe(console.log)</span><br></pre></td></tr></table></figure>
<p>5.<code>empty</code></p>
<blockquote>
<p>Observable可以订阅一个空的事件，不会返回任何东西会立即返回complete</p>
</blockquote>
<p>6.<code>never</code></p>
<blockquote>
<p>Observable也可以订阅一个无穷的事件，不会返回任何东西但是会一直存在不会complete</p>
</blockquote>
<p>7.<code>thorw</code></p>
<blockquote>
<p>此方法只会抛出错误<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">var source = Rx.Observable.thorw(&quot;thow&quot;);</span><br><span class="line">source.subscribe(&#123;</span><br><span class="line">	next: function(value) &#123;</span><br><span class="line">		console.log(value)</span><br><span class="line">	&#125;,</span><br><span class="line">	complete: function() &#123;</span><br><span class="line">		console.log(&apos;complete!&apos;);</span><br><span class="line">	&#125;,</span><br><span class="line">	error: function(error) &#123;</span><br><span class="line">	    console.log(&apos;Throw Error: &apos; + error)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;);</span><br><span class="line">// Throw Error: thow!</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>8.<code>interval</code></p>
<blockquote>
<p>interval必须有一个number数值，代表发出的时间间隔</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">var source = Rx.Observable.interval(1000);</span><br><span class="line">source.subscribe(&#123;</span><br><span class="line">	next: function(value) &#123;</span><br><span class="line">		console.log(value)</span><br><span class="line">	&#125;,</span><br><span class="line">	complete: function() &#123;</span><br><span class="line">		console.log(&apos;complete!&apos;);</span><br><span class="line">	&#125;,</span><br><span class="line">	error: function(error) &#123;</span><br><span class="line">	    console.log(&apos;Throw Error: &apos; + error)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;);</span><br><span class="line">// 0</span><br><span class="line">// 1</span><br><span class="line">// 2</span><br></pre></td></tr></table></figure>
<p>9.<code>timer</code><br>当timer有两个参数时，第一个参数代表要发出第一个值的等待时间(ms)，第二个参数代表第一次之后发送值的间隔时间，所以上面这段程式码会先等一秒送出1之后每五秒送出2, 3, 4, 5…。</p>
<p>timer 第一个参数除了可以是数值(Number)之外，也可以是日期(Date)，就会等到指定的时间在发送第一个值。</p>
<p>另外timer也可以只接收一个参数<br>10.<code>unsubscribe</code></p>
<blockquote>
<p>停止订阅</p>
</blockquote>
<p>###三、Observer观察者</p>
<blockquote>
<p><code>observer</code>分别拥有三个方法 <code>next</code>  <code>error</code>   <code>complete</code></p>
</blockquote>
<p>观察者的三个方法(method)：</p>
<ul>
<li><p><code>next</code>：每当<code>Observable</code> 发送出新的值，<code>next</code> 方法就会被呼叫。</p>
</li>
<li><p><code>complete</code>：在<code>Observable</code> 没有其他的资料可以取得时，<code>complete</code> 方法就会被呼叫，在<code>complete</code> 被呼叫之后，<code>next</code> 方法就不会再起作用。</p>
</li>
<li><p><code>error</code>：每当<code>Observable</code> 内发生错误时，<code>error</code> 方法就会被呼叫。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">var observable = Rx.Observable</span><br><span class="line">                .create((observer) =&gt; &#123;</span><br><span class="line">                    observer.next(&apos;111&apos;);</span><br><span class="line">                    observer.next(&apos;222);</span><br><span class="line">                    observer.compelte()</span><br><span class="line">                    setTimeout(function () &#123;</span><br><span class="line">                        observer.next(&apos;333&apos;);</span><br><span class="line">                    &#125;)</span><br><span class="line">                &#125;);</span><br><span class="line">var observer = &#123;</span><br><span class="line">    next: (value) =&gt; &#123;</span><br><span class="line">        console.log(value)</span><br><span class="line">    &#125;,</span><br><span class="line">    error: (error) =&gt; &#123;</span><br><span class="line">        console.log(value)</span><br><span class="line">    &#125;,</span><br><span class="line">    complete: () =&gt; &#123;</span><br><span class="line">        console.log(&apos;compelte&apos;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">observable.subscribe(observer);</span><br><span class="line">  //上面代码会输出:</span><br><span class="line">  111</span><br><span class="line">  222</span><br><span class="line">  //可以看出当compelte执行完之后的next会失效</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>###三、Observable的Operators方法</p>
<blockquote>
<p>转换（transformation） 过滤（filter） 合并（combination）<br>1.map<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var source = Rx.Observable.interval(1000);</span><br><span class="line">var newest = source.map(x = x+1);</span><br><span class="line">newest.subscribe(console.log())</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>珠宝图 Marble diagrams<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">source: -----0-----1-----2-----3--...</span><br><span class="line">            map(x =&gt; x + 1)</span><br><span class="line">newest: -----1-----2-----3-----4--...</span><br></pre></td></tr></table></figure></p>
<p>2.mapTo</p>
<blockquote>
<p>mapTo可以吧传进来的值改成指定的值<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var source = Rx.Observable.interval(1000);</span><br><span class="line">var newest = source.mapTo(2);</span><br><span class="line">newest.subscribe(console.log);</span><br><span class="line">//</span><br><span class="line">2</span><br><span class="line">2</span><br><span class="line">2</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>珠宝图Marble diagrams</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">source: -----0-----1-----2-----3--...</span><br><span class="line">                mapTo(2)</span><br><span class="line">newest: -----2-----2-----2-----2--...</span><br></pre></td></tr></table></figure>
<p>3.filter</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">var source = Rx.Observable.interval(1000);</span><br><span class="line">var newest = source.filter(x =&gt; x % 2 === 0); </span><br><span class="line"></span><br><span class="line">newest.subscribe(console.log);</span><br><span class="line">// 0</span><br><span class="line">// 2</span><br><span class="line">// 4</span><br><span class="line">// 6..</span><br></pre></td></tr></table></figure>
<p>珠宝图Marble diagrams</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">source: -----0-----1-----2-----3-----4-...</span><br><span class="line">            filter(x =&gt; x % 2 === 0)</span><br><span class="line">newest: -----0-----------2-----------4-...</span><br></pre></td></tr></table></figure>
<p>4.take</p>
<blockquote>
<p>take表示取前几个就结束<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">var source = Rx.Observable.interval(1000);</span><br><span class="line">var example = source.take(3);</span><br><span class="line">example.subscribe(&#123;</span><br><span class="line">	next:(val) =&gt; &#123;console.log(val)&#125;;</span><br><span class="line">	error: (err) =&gt; &#123;console.log(err)&#125;;</span><br><span class="line">	complete: () =&gt; &#123;console.log(complete)&#125;;</span><br><span class="line">&#125;)</span><br><span class="line">//</span><br><span class="line">0</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">complete</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>珠宝图Marble diagrams<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">source : -----0-----1-----2-----3--..</span><br><span class="line">                take(3)</span><br><span class="line">example: -----0-----1-----2|</span><br></pre></td></tr></table></figure></p>
<p>5.first</p>
<blockquote>
<p>和take差不多取第一个就结束</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">var source = Rx.Observable.interval(1000);</span><br><span class="line">var example = source.first();</span><br><span class="line">example.subscribe(&#123;</span><br><span class="line">	next:(val) =&gt; &#123;console.log(val)&#125;;</span><br><span class="line">	error: (err) =&gt; &#123;console.log(err)&#125;;</span><br><span class="line">	complete: () =&gt; &#123;console.log(complete)&#125;;</span><br><span class="line">&#125;)</span><br><span class="line">//</span><br><span class="line">0</span><br><span class="line"></span><br><span class="line">complete</span><br></pre></td></tr></table></figure>
<p>珠宝图Marble diagrams<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">source : -----0-----1-----2-----3--..</span><br><span class="line">                first()</span><br><span class="line">example: -----0|</span><br></pre></td></tr></table></figure></p>
<p>6.takeUntil</p>
<blockquote>
<p>直到某个事件发生以后才结束发出compelte<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">var source = Rx.Observable.interval(1000);</span><br><span class="line">var click = Rx.Observable.fromEvent(document.body, &apos;click&apos;);</span><br><span class="line">var example = source.takeUntil(click);     </span><br><span class="line">   </span><br><span class="line">example.subscribe(&#123;</span><br><span class="line">    next: (value) =&gt; &#123; console.log(value); &#125;,</span><br><span class="line">    error: (err) =&gt; &#123; console.log(&apos;Error: &apos; + err); &#125;,</span><br><span class="line">    complete: () =&gt; &#123; console.log(&apos;complete&apos;); &#125;</span><br><span class="line">&#125;);</span><br><span class="line">// 0</span><br><span class="line">// 1</span><br><span class="line">// 2</span><br><span class="line">// 3</span><br><span class="line">// complete (點擊body了</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>珠宝图Marble diagrams<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">source : -----0-----1-----2------3--</span><br><span class="line">click  : ----------------------c----</span><br><span class="line">                takeUntil(click)</span><br><span class="line">example: -----0-----1-----2----|</span><br></pre></td></tr></table></figure></p>
<p>7.concatAll</p>
<blockquote>
<p>相当于把二维数组转换成一维数组<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var click = Rx.Observable.fromEvent(document.body, &apos;click&apos;);</span><br><span class="line">var source = click.map(e =&gt; Rx.Observable.of(1,2,3));</span><br><span class="line"></span><br><span class="line">var example = source.concatAll();</span><br><span class="line">example.subscribe(&#123;</span><br><span class="line">    next: (value) =&gt; &#123; console.log(value); &#125;,</span><br><span class="line">    error: (err) =&gt; &#123; console.log(&apos;Error: &apos; + err); &#125;,</span><br><span class="line">    complete: () =&gt; &#123; console.log(&apos;complete&apos;); &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>珠宝图Marble diagrams<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">click  : ------c------------c--------</span><br><span class="line"></span><br><span class="line">        map(e =&gt; Rx.Observable.of(1,2,3))</span><br><span class="line"></span><br><span class="line">source : ------o------------o--------</span><br><span class="line">                \            \</span><br><span class="line">                 (123)|       (123)|</span><br><span class="line"></span><br><span class="line">                   concatAll()</span><br><span class="line"></span><br><span class="line">example: ------(123)--------(123)------------</span><br></pre></td></tr></table></figure></p>
<p>这里可以看到sourceobservable内部每次发送的值也是observable，这时我们用concatAll就可以把source摊平成example。</p>
<p>这里需要注意的是concatAll会处理source先发出来的observable，必须等到这个observable结束，才会再处理下一个source发出来的observable，让我们用下面这个范例说明。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">var obs1 = Rx.Observable.interval(1000).take(5);</span><br><span class="line">var obs2 = Rx.Observable.interval(500).take(2);</span><br><span class="line">var obs3 = Rx.Observable.interval(2000).take(1);</span><br><span class="line"></span><br><span class="line">var source = Rx.Observable.of(obs1, obs2, obs3);</span><br><span class="line"></span><br><span class="line">var example = source.concatAll();</span><br><span class="line"></span><br><span class="line">example.subscribe(&#123;</span><br><span class="line">    next: (value) =&gt; &#123; console.log(value); &#125;,</span><br><span class="line">    error: (err) =&gt; &#123; console.log(&apos;Error: &apos; + err); &#125;,</span><br><span class="line">    complete: () =&gt; &#123; console.log(&apos;complete&apos;); &#125;</span><br><span class="line">&#125;);</span><br><span class="line">// 0</span><br><span class="line">// 1</span><br><span class="line">// 2</span><br><span class="line">// 3</span><br><span class="line">// 4</span><br><span class="line">// 0</span><br><span class="line">// 1</span><br><span class="line">// 0</span><br><span class="line">// complete</span><br></pre></td></tr></table></figure>
<p>8.skip</p>
<blockquote>
<p>省略前几个发送的元素</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">var source = Rx.Observable.interval(1000);</span><br><span class="line">var example = source.skip(3);</span><br><span class="line"></span><br><span class="line">example.subscribe(&#123;</span><br><span class="line">    next: (value) =&gt; &#123; console.log(value); &#125;,</span><br><span class="line">    error: (err) =&gt; &#123; console.log(&apos;Error: &apos; + err); &#125;,</span><br><span class="line">    complete: () =&gt; &#123; console.log(&apos;complete&apos;); &#125;</span><br><span class="line">&#125;);</span><br><span class="line">// 3</span><br><span class="line">// 4</span><br><span class="line">// 5...</span><br></pre></td></tr></table></figure>
<p>珠宝图<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">source : ----0----1----2----3----4----5--....</span><br><span class="line">                    skip(3)</span><br><span class="line">example: -------------------3----4----5--...</span><br></pre></td></tr></table></figure></p>
<p>9.takeLast</p>
<blockquote>
<p>取最后第几个值</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">var source = Rx.Observable.interval(1000).take(6);</span><br><span class="line">var example = source.takeLast(2);</span><br><span class="line"></span><br><span class="line">example.subscribe(&#123;</span><br><span class="line">    next: (value) =&gt; &#123; console.log(value); &#125;,</span><br><span class="line">    error: (err) =&gt; &#123; console.log(&apos;Error: &apos; + err); &#125;,</span><br><span class="line">    complete: () =&gt; &#123; console.log(&apos;complete&apos;); &#125;</span><br><span class="line">&#125;);</span><br><span class="line">// 4</span><br><span class="line">// 5</span><br><span class="line">// complete</span><br></pre></td></tr></table></figure>
<p>珠宝图<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">source : ----0----1----2----3----4----5|</span><br><span class="line">                takeLast(2)</span><br><span class="line">example: ------------------------------(45)|</span><br></pre></td></tr></table></figure></p>
<p>10.last</p>
<blockquote>
<p>去最后一个元素<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">var source = Rx.Observable.interval(1000).take(6);</span><br><span class="line">var example = source.last();</span><br><span class="line"></span><br><span class="line">example.subscribe(&#123;</span><br><span class="line">    next: (value) =&gt; &#123; console.log(value); &#125;,</span><br><span class="line">    error: (err) =&gt; &#123; console.log(&apos;Error: &apos; + err); &#125;,</span><br><span class="line">    complete: () =&gt; &#123; console.log(&apos;complete&apos;); &#125;</span><br><span class="line">&#125;);</span><br><span class="line">// 5</span><br><span class="line">// complete</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>珠宝图<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">source : ----0----1----2----3----4----5|</span><br><span class="line">                    last()</span><br><span class="line">example: ------------------------------(5)|</span><br><span class="line">```	</span><br><span class="line">11.concat</span><br><span class="line">&gt;把多个实例合并成一个</span><br></pre></td></tr></table></figure></p>
<p>var source = Rx.Observable.interval(1000).take(3);<br>var source2 = Rx.Observable.of(3)<br>var source3 = Rx.Observable.of(4,5,6)<br>var example = source.concat(source2, source3);</p>
<p>example.subscribe({<br>    next: (value) =&gt; { console.log(value); },<br>    error: (err) =&gt; { console.log(‘Error: ‘ + err); },<br>    complete: () =&gt; { console.log(‘complete’); }<br>});<br>// 0<br>// 1<br>// 2<br>// 3<br>// 4<br>// 5<br>// 6<br>// complete<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">珠宝图</span><br></pre></td></tr></table></figure></p>
<p>source : —-0—-1—-2|<br>source2: (3)|<br>source3: (456)|<br>            concat()<br>example: —-0—-1—-2(3456)|<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">12.startWith</span><br><span class="line">&gt;表示一开始要发送的元素可以在前面插入</span><br></pre></td></tr></table></figure></p>
<p>var source = Rx.Observable.interval(1000);<br>var example = source.startWith(0);</p>
<p>example.subscribe({<br>    next: (value) =&gt; { console.log(value); },<br>    error: (err) =&gt; { console.log(‘Error: ‘ + err); },<br>    complete: () =&gt; { console.log(‘complete’); }<br>});<br>// 0<br>// 0<br>// 1<br>// 2<br>// 3…<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">珠宝图</span><br></pre></td></tr></table></figure></p>
<p>source : —-0—-1—-2—-3–…<br>                startWith(0)<br>example: (0)—-0—-1—-2—-3–…<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">13.merge</span><br><span class="line">&gt;合并多个实例</span><br></pre></td></tr></table></figure></p>
<p>var source = Rx.Observable.interval(500).take(3);<br>var source2 = Rx.Observable.interval(300).take(6);<br>var example = source.merge(source2);</p>
<p>example.subscribe({<br>    next: (value) =&gt; { console.log(value); },<br>    error: (err) =&gt; { console.log(‘Error: ‘ + err); },<br>    complete: () =&gt; { console.log(‘complete’); }<br>});<br>// 0<br>// 0<br>// 1<br>// 2<br>// 1<br>// 3<br>// 2<br>// 4<br>// 5<br>// complete<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">珠宝图</span><br></pre></td></tr></table></figure></p>
<p>source : —-0—-1—-2|<br>source2: –0–1–2–3–4–5|<br>            merge()<br>example: –0-01–21-3–(24)–5|<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">merge 的邏輯有點像是 OR(||)，就是當兩個 observable 其中一個被觸發時都可以被處理，這很常用在一個以上的按鈕具有部分相同的行為。</span><br><span class="line"></span><br><span class="line">例如一個影片播放器有兩個按鈕，一個是暫停(II)，另一個是結束播放(口)。這兩個按鈕都具有相同的行為就是影片會被停止，只是結束播放會讓影片回到 00 秒，這時我們就可以把這兩個按鈕的事件 merge 起來處理影片暫停這件事。</span><br></pre></td></tr></table></figure></p>
<p>var stopVideo = Rx.Observable.merge(stopButton, endButton);</p>
<p>stopVideo.subscribe(() =&gt; {<br>    // 暫停播放影片<br>})<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https://ithelp.ithome.com.tw/articles/10187638</span><br><span class="line">14.combineLatest</span><br><span class="line">&gt;首先我們要介紹的是 combineLatest，它會取得各個 observable 最後送出的值，再輸出成一個值，我們直接看範例會比較好解釋。</span><br></pre></td></tr></table></figure></p>
<p>var source = Rx.Observable.interval(500).take(3);<br>var newest = Rx.Observable.interval(300).take(6);</p>
<p>var example = source.combineLatest(newest, (x, y) =&gt; x + y);</p>
<p>example.subscribe({<br>    next: (value) =&gt; { console.log(value); },<br>    error: (err) =&gt; { console.log(‘Error: ‘ + err); },<br>    complete: () =&gt; { console.log(‘complete’); }<br>});<br>// 0<br>// 1<br>// 2<br>// 3<br>// 4<br>// 5<br>// 6<br>// 7<br>// complete<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">珠宝图</span><br></pre></td></tr></table></figure></p>
<p>source : —-0—-1—-2|<br>newest : –0–1–2–3–4–5|</p>
<pre><code>combineLatest(newest, (x, y) =&gt; x + y);
</code></pre><p>example: —-01–23-4–(56)–7|<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">首先combineLatest可以接收多个observable，最后一个参数是callback function，这个callback function接收的参数数量跟合并的observable数量相同，依照范例来说，因为我们这里合并了两个observable所以后面的callback function就接收x, y两个参数，x会接收从source发送出来的值，y会接收从newest发送出来的值。</span><br><span class="line"></span><br><span class="line">最后一个重点就是一定会等两个observable都曾有送值出来才会呼叫我们传入的callback，所以这段程式是这样运行的</span><br><span class="line"></span><br><span class="line">- newest送出了0，但此时source并没有送出过任何值，所以不会执行callback</span><br><span class="line">- source送出了0，此时newest最后一次送出的值为0，把这两个数传入callback得到0。</span><br><span class="line">- newest送出了1，此时source最后一次送出的值为0，把这两个数传入callback得到1。</span><br><span class="line">- newest送出了2，此时source最后一次送出的值为0，把这两个数传入callback得到2。</span><br><span class="line">- source送出了1，此时newest最后一次送出的值为2，把这两个数传入callback得到3。</span><br><span class="line">- newest送出了3，此时source最后一次送出的值为1，把这两个数传入callback得到4。</span><br><span class="line">- source送出了2，此时newest最后一次送出的值为3，把这两个数传入callback得到5。</span><br><span class="line">- source 结束，但newest 还没结束，所以example 还不会结束。</span><br><span class="line">- newest送出了4，此时source最后一次送出的值为2，把这两个数传入callback得到6。</span><br><span class="line">- newest送出了5，此时source最后一次送出的值为2，把这两个数传入callback得到7。</span><br><span class="line">- newest 结束，因为source 也结束了，所以example 结束。</span><br><span class="line">不管是source 还是newest 送出值来，只要另一方曾有送出过值(有最后的值)，就会执行callback 并送出新的值，这就是combineLatest。</span><br><span class="line"></span><br><span class="line">combineLatest 很常用在运算多个因子的结果，例如最常见的BMI 计算，我们身高变动时就拿上一次的体重计算新的BMI，当体重变动时则拿上一次的身高计算BMI，这就很适合用combineLatest 来处理！</span><br><span class="line">15.zip</span><br><span class="line">&gt;在讲withLatestFrom 之前，先让我们先来看一下zip 是怎么运作的，zip 会取每个observable 相同顺位的元素并传入callback，也就是说每个observable 的第n 个元素会一起被传入callback ，这里我们同样直接用范例讲解会比较清楚</span><br></pre></td></tr></table></figure></p>
<p>var source = Rx.Observable.interval(500).take(3);<br>var newest = Rx.Observable.interval(300).take(6);</p>
<p>var example = source.zip(newest, (x, y) =&gt; x + y);</p>
<p>example.subscribe({<br>    next: (value) =&gt; { console.log(value); },<br>    error: (err) =&gt; { console.log(‘Error: ‘ + err); },<br>    complete: () =&gt; { console.log(‘complete’); }<br>});<br>// 0<br>// 2<br>// 4<br>// complete<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">珠宝图</span><br></pre></td></tr></table></figure></p>
<p>source : —-0—-1—-2|<br>newest : –0–1–2–3–4–5|<br>    zip(newest, (x, y) =&gt; x + y)<br>example: —-0—-2—-4|<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">以我们的范例来说，zip会等到source跟newest 都送出了第一个元素，再传入callback，下次则等到source跟newest 都送出了第二个元素再一起传入callback，所以运行的步骤如下：</span><br><span class="line"></span><br><span class="line">- newest送出了第一个值0，但此时source并没有送出第一个值，所以不会执行callback。</span><br><span class="line">- source送出了第一个值0，newest之前送出的第一个值为0，把这两个数传入callback得到0。</span><br><span class="line">- newest送出了第二个值1，但此时source并没有送出第二个值，所以不会执行callback。</span><br><span class="line">- newest送出了第三个值2，但此时source并没有送出第三个值，所以不会执行callback。</span><br><span class="line">- source送出了第二个值1，newest之前送出的第二个值为1，把这两个数传入callback得到2。</span><br><span class="line">- newest送出了第四个值3，但此时source并没有送出第四个值，所以不会执行callback。</span><br><span class="line">- source送出了第三个值2，newest之前送出的第三个值为2，把这两个数传入callback得到4。</span><br><span class="line">- source 结束example 就直接结束，因为source 跟newest 不会再有对应顺位的值</span><br><span class="line">zip 会把各个observable 相同顺位送出的值传入callback，这很常拿来做demo 使用，比如我们想要间隔100ms 送出&apos;h&apos;, &apos;e&apos;, &apos;l&apos;, &apos;l&apos;, &apos;o&apos;，就可以这么做</span><br></pre></td></tr></table></figure></p>
<p>var source = Rx.Observable.from(‘hello’);<br>var source2 = Rx.Observable.interval(100);</p>
<p>var example = source.zip(source2, (x, y) =&gt; x);<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">这里的Marble Diagram 就很简单</span><br></pre></td></tr></table></figure></p>
<p>source : (hello)|<br>source2: -0-1-2-3-4-…<br>        zip(source2, (x, y) =&gt; x)<br>example: -h-e-l-l-o|<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">这里我们利用zip 来达到原本只能同步送出的资料变成了非同步的，很适合用在建立示范用的资料。</span><br><span class="line"></span><br><span class="line">建议大家平常没事不要乱用zip，除非真的需要。因为zip 必须cache 住还没处理的元素，当我们两个observable 一个很快一个很慢时，就会cache 非常多的元素，等待比较慢的那个observable。这很有可能造成记忆体相关的问题！</span><br><span class="line">16.withLatestFrom</span><br><span class="line">&gt;withLatestFrom 运作方式跟combineLatest 有点像，只是他有主从的关系，只有在主要的observable 送出新的值时，才会执行callback，附随的observable 只是在背景下运作。让我们看一个例子</span><br></pre></td></tr></table></figure></p>
<p>var main = Rx.Observable.from(‘hello’).zip(Rx.Observable.interval(500), (x, y) =&gt; x);<br>var some = Rx.Observable.from([0,1,0,0,0,1]).zip(Rx.Observable.interval(300), (x, y) =&gt; x);</p>
<p>var example = main.withLatestFrom(some, (x, y) =&gt; {<br>    return y === 1 ? x.toUpperCase() : x;<br>});</p>
<p>example.subscribe({<br>    next: (value) =&gt; { console.log(value); },<br>    error: (err) =&gt; { console.log(‘Error: ‘ + err); },<br>    complete: () =&gt; { console.log(‘complete’); }<br>});<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">珠宝图Marble diagrams</span><br></pre></td></tr></table></figure></p>
<p>main   : —-h—-e—-l—-l—-o|<br>some   : –0–1–0–0–0–1|</p>
<p>withLatestFrom(some, (x, y) =&gt;  y === 1 ? x.toUpperCase() : x);</p>
<p>example: —-h—-e—-l—-L—-O|<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">withLatestFrom 会在main 送出值的时候执行callback，但请注意如果main 送出值时some 之前没有送出过任何值callback 仍然不会执行！</span><br><span class="line"></span><br><span class="line">这里我们在main 送出值时，去判断some 最后一次送的值是不是1 来决定是否要切换大小写，执行步骤如下</span><br><span class="line"></span><br><span class="line">- main送出了h，此时some上一次送出的值为0，把这两个参数传入callback得到h。</span><br><span class="line">- main送出了e，此时some上一次送出的值为0，把这两个参数传入callback得到e。</span><br><span class="line">- main送出了l，此时some上一次送出的值为0，把这两个参数传入callback得到l。</span><br><span class="line">- main送出了l，此时some上一次送出的值为1，把这两个参数传入callback得到L。</span><br><span class="line">- main送出了o，此时some上一次送出的值为1，把这两个参数传入callback得到O。</span><br><span class="line">withLatestFrom 很常用在一些checkbox 型的功能，例如说一个编辑器，我们开启粗体后，打出来的字就都要变粗体，粗体就像是some observable，而我们打字就是main </span><br><span class="line">###四、实战实现简易拖拉</span><br></pre></td></tr></table></figure></p>
<p>const dragDOM = document.getElementById(‘drag’);<br>const body = document.body;</p>
<p>const mouseDown = Rx.Observable.fromEvent(dragDOM, ‘mousedown’);<br>const mouseUp = Rx.Observable.fromEvent(body, ‘mouseup’);<br>const mouseMove = Rx.Observable.fromEvent(body, ‘mousemove’);</p>
<p>mouseDown<br>  .map(event =&gt; mouseMove.takeUntil(mouseUp))<br>  .concatAll()<br>  .map(event =&gt; ({ x: event.clientX, y: event.clientY }))<br>  .subscribe(pos =&gt; {<br>      dragDOM.style.left = pos.x + ‘px’;<br>    dragDOM.style.top = pos.y + ‘px’;<br>  })<br><code>`</code></p>

        </div>

        <blockquote class="post-copyright">
    <div class="content">
        

        
    </div>
    <footer>
        <a href="http://yoursite.com">
            <img src="/img/logo.jpg" alt="_sUper.LEE">
            _sUper.LEE
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>



        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/RXJS/">RXJS</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://yoursite.com/2018/01/13/RX.js/&title=《RXJS》 — _sUper.LEE的个人空间&pic=http://yoursite.com/img/logo.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://yoursite.com/2018/01/13/RX.js/&title=《RXJS》 — _sUper.LEE的个人空间&source=LEE Blog" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://yoursite.com/2018/01/13/RX.js/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《RXJS》 — _sUper.LEE的个人空间&url=http://yoursite.com/2018/01/13/RX.js/&via=http://yoursite.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://yoursite.com/2018/01/13/RX.js/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2018/01/27/eslint/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">eslint 常用配置</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2017/11/20/react-study-Immutable/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">React之Immutable学习记录（十二）</h4>
      </a>
    </div>
  
</nav>



    





<section class="comments" id="comments">
    <!-- UY BEGIN -->
    <div id="uyan_frame"></div>
    <script src="http://v2.uyan.cc/code/uyan.js?uid=true"></script>
    <!-- UY END -->
</section>










</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        谢谢大爷~
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/ewm.png" alt="打赏二维码">
        </div>
        
    </div>
</div>



</div>

        <footer class="footer">
    <!-- <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>footer.license</span>
        </p>
    </div> -->
    <div class="bottom">
        <p><span>_sUper.LEE &copy; 2015 - 2018</span>
            <span>
                
                <!-- Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a> -->
            </span>
        </p>
    </div>
  
</footer>

    </main>
    <div class="mask" id="mask">
  
</div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://yoursite.com/2018/01/13/RX.js/&title=《RXJS》 — _sUper.LEE的个人空间&pic=http://yoursite.com/img/logo.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://yoursite.com/2018/01/13/RX.js/&title=《RXJS》 — _sUper.LEE的个人空间&source=LEE Blog" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://yoursite.com/2018/01/13/RX.js/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《RXJS》 — _sUper.LEE的个人空间&url=http://yoursite.com/2018/01/13/RX.js/&via=http://yoursite.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://yoursite.com/2018/01/13/RX.js/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAK4AAACuCAAAAACKZ2kyAAAByElEQVR42u3aQW7DMAwEQP//0y3QU4G26lKUGQcYn4zEkcY5CORK1xVfH1/X+v77J39dP5+57rhwcXHb3HyCNXFNScZcG3Bxcee5yeKVPJl8u6b/MzIuLu7DuHnV0S+VcHFx34W7Lm7yhQwXF/dduHmQkX++Lmhu79VwcXEb3FOBaef+BfkuLi7u1q5EskjtveTm7Li4uCPcZGtkHXR2WqCk6CkPhIuL2+bmi0t1g6S6uRKNg4uLO8g9BTobo/wyMi4u7gh3rwnplETVJ8v5Li4ubpubHJnqlCYJLo9OcHFxJ7nVRmXv6NXeLsmV/5e4uLiHuHl8WY04o9qqGLni4uLOcDuHsXJ0oYhZ/woXF3eEmy8o1Zam2lDh4uI+h5sfm4gakrgOqWa6uLi4k9xk8cq3UasraN4U4eLiTnL3puxsjeSvjYuL+1ru3tGrzpGsaoyLi4s7z60exqq2Q9UXK/dVuLi4R7l3TNMpdPrHOHBxcU9x88VrbwskiUUKxRAuLu4g947FK2+fDue7uLi4g9ykHNk7zFFoinBxcR/J7YQseXGDi4v7BG51gnWL0mmojsUiuLi4DW41ME3Ci2ojlIcpuLi4N3M/AWrAdp052/d1AAAAAElFTkSuQmCC" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '死鬼去哪里了！';
            clearTimeout(titleTime);
        } else {
            document.title = '(つェ⊂)咦!又好了!';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>


<!-- <script src="//unpkg.com/hexo-theme-material-indigo@latest/js/particles.min.js"></script>
<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/app.min.js"></script> -->
</body>
</html>
